* Idea of workflow
Here is an example of a manually performed analysis that can work as
the backbone for analysis that should be part of the pipeline. As an
example a fairly well characterized order of Salmoniformes is used. In
Sweden there are only 13 species from this group and several of these
are introduced ones.

** Bags
1. Use the search term Salmoniformes on the Taxa selection in the app
   and requiring at least 300bp of sequence length and retain only
   samples with geographic data.
2. This does at 20210611 download 3220 entries that are saved as a
   tab delimited file looking like this:
   | species               | BIN          | sequence                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | country | grade | family     | order         | class          | sampleid       | processid     | lattitude | longitude | base_number |
   |-----------------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+-------+------------+---------------+----------------+----------------+---------------+-----------+-----------+-------------|
   | Brachymystax lenok    | BOLD:AAW7706 | CCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTGATCCGAGCAGAACTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCTGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCATGCAGGGGCTTCCGTTGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATTAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTTTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | MG951557       | ANGBF41021-19 | NA        | NA        |         652 |
   | Brachymystax lenok    | BOLD:AAW7706 | CCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTAATCCGAGCAGAATTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCGGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCACGCAGGGGCTTCCGTCGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATCAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTCTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | MG951554       | ANGBF41018-19 | NA        | NA        |         652 |
   | Brachymystax lenok    | BOLD:AAW7706 | CCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTAATCCGAGCAGAATTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCGGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCACGCAGGGGCTTCCGTCGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATCAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTCTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | Hoz-46         | EEFF075-06    | 44.767    | 133.572   |         652 |
   | Brachymystax lenok    | BOLD:AAW7706 | CTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTAATCCGAGCAGAATTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCGGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCCCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGATGAACAGTCTACCCCCCTCTAGCTGGAAACCTTGCCCACGCAGGGGCTTCCGTCGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTGGGAGCCATTAATTTTATTACAACCATTATCAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTTTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTCTTTTGATTCTTTGGCCACC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | China   | E     | Salmonidae | Salmoniformes | Actinopterygii | KT716377       | ANGBF41017-19 | NA        | NA        |         650 |
   | Brachymystax lenok    | BOLD:AAW7706 | CCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTGATCCGAGCAGAACTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCTGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCATGCAGGGGCTTCCGTTGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATTAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTTTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | MG951556       | ANGBF41020-19 | NA        | NA        |         652 |
   | Brachymystax lenok    | BOLD:AAW7706 | CCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTAATCCGAGCAGAATTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCGGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCACGCAGGGGCTTCCGTCGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATCAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTCTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | MG951555       | ANGBF41019-19 | NA        | NA        |         652 |
   | Brachymystax savinovi | BOLD:AAW7706 | GTGGCAATCACACGACGATGATTTTTCTCAACCAACCACAAAGACATTGGCACCCTCTATTTAGTATTTGGTGCATGAGCCGGGATAGTCGGCACAGCCCTAAGCCTCTTGATCCGAGCAGAACTAAGCCAGCCCGGAGCTCTTCTGGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTTATACCAATCATGATTGGAGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCTGACATAGCATTCCCTCGAATAAATAACATGAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCACGCAGGGGCTTCCGTTGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATCAACATAAAACCCCCAGCCATTTCTCAGTATCAGACCCCACTTTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACGGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGGGACCCAATCCTGTACCAACACCTCTTTTGATTCTTCGGCCACCCAGAGGTCTATATTCTTATTCTCCCAGGTTTTGGTATAATTTCCCATATCGTTGCCTATTATTCAGGTAAAAAAGAACCTTTCGGGTACATGGGAATAGTCTGAGCTATAATAGCCATCGGACTCTTAGGGTTCATCGTTTGAGCCCACCACATGTTTACTGTTGGCATGGACGTAGACACTCGTGCTTACTTTACATCCGCCACCATAATCATTGCCATCCCCACAGGAGTAAAAGTATTTAGCTGATTAGCTACATTACATGGCGGCTCAATCAAATGAGAAACGCCACTTCTCTGAGCCCTAGGGTTTATTTTCCTATTTACAGTGGGAGGACTCACGGGCATTGTTCTTGCTAACTCCTCATTAGACATCGTCCTCCACGACACTTATTATGTGGTCGCTCATTTCCACTATGTACTATCTATGGGAGCTGTCTTTGCCATCATGGGCGCCTTCGTACACTGATTTCCGTTATTTACAGGATATACCCTTCACAGCACATGAACCAAAATCCATTTTGGAATTATGTTCATCGGCGTGAATTTAACCTTTTTCCCCCAGCATTTCCTTGGCCTTGCAGGGATGCCACGGCGATACTCTGACTACCCAGACGCTTACACACTATGAAACACAGTATCCTCAATTGGGTCTCTTATCTCCTTAGTTGCTGTAATTATGTCTCTG                                                                                                                         | China   | E     | Salmonidae | Salmoniformes | Actinopterygii | KY124134       | ANGBF41022-19 | NA        | NA        |        1410 |
   | Brachymystax tumensis | BOLD:AAW7706 | TTTTTCTCAACCAACCACAAAGACATTGGCACCCTCTATTTAGTATTTGGTGCCTGAGCCGGGATAGTCGGCACAGCCCTAAGTCTCTTGATCCGAGCAGAACTAAGCCAGCCCGGAGCTCTTCTAGGGGATGACCAAATCTATAACGTAATCGTCACGGCCCATGCCTTCGTTATAATTTTCTTTATAGTCATACCAATCATAATCGGGGGCTTTGGGAACTGATTGATTCCACTTATAATTGGAGCCCCTGACATAGCATTCCCTCGAATAAATAACATAAGCTTCTGGCTTCTCCCTCCATCTTTTCTTCTCCTCTTAGCTTCGTCTGGAGTTGAAGCCGGCGCCGGCACAGGGTGAACAGTCTACCCCCCTCTAGCTGGGAACCTTGCCCATGCAGGGGCTTCCGTTGATTTAACTATTTTCTCCCTCCATTTGGCTGGTATTTCCTCAATTTTAGGAGCCATTAATTTTATTACAACCATTATTAACATAAAACCCCCAGCCATTTCTCAGTATCAAACCCCACTTTTTGTTTGAGCTGTCCTAGTTACTGCTGTCCTCTTACTACTCTCCCTCCCCGTCTTAGCAGCGGGCATCACTATGTTACTTACAGACCGAAATCTAAATACCACTTTCTTTGACCCAGCAGGCGGAGGAGACCCAATCCTGTACCAACACCTCTTTTGATTCTTCGGCCACCCAGAAGTCTATATTCTTATTCTCCCAGGCTTTGGTATAATTTCTCATATCGTTGCCTATTATTCAGGTAAAAAAGAACCTTTCGGGTACATGGGGATAGTCTGAGCTATAATAGCCATCGGACTCCTAGGGTTCATCGTTTGAGCCCACCACATATTTACTGTTGGTATGGACGTAGACACTCGTGCTTACTTTACATCCGCCACCATAATTATTGCCATCCCCACAGGAGTAAAAGTATTTAGCTGATTAGCTACATTACATGGCGGCTCAATCAAATGAGAAACGCCACTTCTCTGAGCCCTAGGGTTTATTTTCCTATTTACGGTGGGGGGACTCACGGGCATTGTTCTTGCTAATTCCTCATTAGACATCGTCCTCCACGACACTTATTATGTAGTCGCTCATTTCCACTATGTATTATCTATGGGAGCTGTCTTTGCCATCATGGGCGCCTTCGTACACTGATTTCCACTATTTACAGGATATACCCTTCACAGCACATGAACCAAAATCCATTTTGGAATTATGTTCATTGGCGTAAATTTAACCTTTTTCCCCCAGCATTTCCTTGGCCTTGCAGGAATGCCACGGCGATACTCTGACTATCCAGACGCTTACACACTATGAAACACAGTATCCTCAATTGGGTCTCTTATCTCCTTAGTTGCTGTAATTATATTCCTATTTATCCTCTGAGAAGCCTTTGCTGCCAAACGAGAAGTAGCATCAATTGAATTAACTTCAACAAACGTAGAGTGACTACATGGGTGTCCTCCACCTTACCACACATTTGAAGAACCAGCATTTGTTCGAGTACAGGCAAAC | Russia  | E     | Salmonidae | Salmoniformes | Actinopterygii | KC936238       | ANGBF41024-19 | NA        | NA        |        1530 |
   | Coregonus albula      | BOLD:ACE7641 | CTTTATTTAGTATTTGGTGCCTGAGCCGGAATAGTCGGCACAGCCCTAAGCCTTTTAATCCGAGCGGAACTAAGCCAACCCGGGGCTCTTCTGGGGGATGATCAGATTTATAATGTAATCGTCACGGCCCACGCCTTCGTTATGATTTTCTTTATAGTTATGCCAATTATGATTGGAGGCTTTGGAAACTGATTAATCCCACTTATAATCGGGGCCCCCGACATGGCATTTCCCCGAATGAATAATATGAGCTTTTGGCTCCTTCCCCCCTCCTTTCTCCTTCTCCTGGCCTCGTCCGGAGTTGAAGCCGGTGCCGGCACAGGATGAACAGTCTACCCCCCTCTGGCAGGCAACCTCGCCCACGCAGGGGCCTCCGTCGATTTAACTATTTTCTCCCTCCACTTAGCTGGTATTTCCTCTATCTTAGGGGCCGTTAATTTTATTACAACCATTATTAACATGAAACCCCCAGCCATTTCCCAGTATCAAACCCCTCTTTTTGTCTGAGCCGTCTTAATTACCGCAGTCCTTCTACTGCTCTCCCTTCCTGTCCTAGCAGCAGGTATTACCATGCTACTCACAGACCGGAATCTAAACACCACTTTCTTCGACCCAGCGGGCGGAGGAGATCCAATCCTGTATCAGCACCTCN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Germany | E     | Salmonidae | Salmoniformes | Actinopterygii | Coregonen_01B4 | GERFW013-13   | 53.576    | 12.496    |         652 |
   | Coregonus albula      | BOLD:ACE7641 | CTTTATTTAGTATTTGGTGCCTGAGCCGGAATAGTCGGCACAGCCCTAAGCCTTTTAATCCGAGCGGAACTAAGCCAACCCGGGGCTCTTCTGGGGGATGATCAGATTTATAATGTAATCGTCACGGCCCACGCCTTCGTTATGATTTTCTTTATAGTTATGCCAATTATGATTGGAGGCTTTGGAAACTGATTAATCCCACTTATAATCGGGGCCCCCGACATGGCATTTCCCCGAATGAATAATATGAGCTTTTGGCTCCTTCCCCCCTCCTTTCTCCTTCTCCTGGCCTCGTCCGGAGTTGAAGCCGGTGCCGGCACAGGATGAACAGTCTACCCCCCTCTGGCAGGCAACCTCGCCCACGCAGGGGCCTCCGTCGATTTAACTATTTTCTCCCTCCACTTAGCTGGTATTTCCTCTATCTTAGGGGCCGTTAATTTTATTACAACCATTATTAACATGAAACCCCCAGCCATTTCCCAGTATCAAACCCCTCTTTTTGTCTGAGCCGTCTTAATTACCGCAGTCCTTCTACTGCTCTCCCTTCCTGTCCTAGCAGCAGGTATTACTATGCTACTCACAGACCGGAATCTAAACACCACTTTCTTCGACCCAGCGGGCGGAGGAGATCCAATCCTGTATCAGCACCTCN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Germany | E     | Salmonidae | Salmoniformes | Actinopterygii | Coregonen_01D7 | GERFW036-13   | 53.356    | 13.463    |         652 |
   |                       |              | <5>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |         |       |            |               |                |                |               |           |           |             |

3. Download the libraries with different gradings makes sure all
   information is available. Note that the grading is assigned to every
   sequence, but is not only a property of the sequence. A sequence that
   is perfectly fine, will be graded E if there i a single entry in the
   same By identifying entries that is the root cause of the grade, and
   if this turns out to be because of a single or few entries one can
   reanalyse data with those omitted. In cases where the issues are
   caused by multiple entries and can not be resolved the grading E
   should be retained and added next to all sequences as that is groups
   where extra care needs to be taken in order to correctly assign
   taxonomy to sequences being similar to those.
4. If there are more than 10 samples available for a sequence retain
   the longest sequences and retain at least a single entry of every
   variant and store a number that corresponds to the number of samples
   in that database that have that variant. This make some of the
   downstream analysis faster without loosing too much useful
   information. Note that there is no need to retain shorter variants if
   they show perfect overlap with a longer sequence so those can be
   treated as above.

** Blast - NCBI

1. For all species where the above procedure still yields limited
(less than 3) or no sequence data or where the grading is not improved
by filtering data, use blast against the ncbi mito database and
extract all novel data that can be found. NB! there are sequence data
in BOLD that is mined from genbank som make sure not to retain
duplicate entries.

2. If more data is found redo step 4 from the BAGS procedure.

** DECIPHER

1. Import all fasta sequence retained to a sqlite database using the
   DECIPHER package.
2. Create an alignment file for the sequences

** ASAP
1. Run the aligned files through the ASAP analysis and identify 
   the groups that are suitable for taxonomic determination using
   based on the gap analysis.
2. Based on the ASAP analysis add a column where metadata from the
   analysis is added to the sequences, much liket what is done in BAGS.



 


